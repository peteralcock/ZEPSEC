class VulnerabilityPolicy < ApplicationPolicy
  include RecordPolicy

  def permitted_attributes
    [:codename,
     :vulnerability_kind_id,
     :feed,
     :custom_vendors_str,
     :custom_products_str,
     :custom_codenames_str,
     :custom_cvss3,
     :custom_cvss3_vector,
     :custom_cvss3_exploitability,
     :custom_cvss3_impact,
     :custom_published,
     :custom_published_time,
     :modified,
     :modified_time,
     :state,
     :processed,
     :custom_actuality,
     :custom_relevance,
     :custom_description,
     :custom_references,
     {custom_fields: Vulnerability.custom_fields_names},
     :custom_recomendation,
     :custom_exploit_maturity]
  end

  def search?
    index?
  end

  def run?
    create?
  end

  def toggle_processed?
    create?
  end

  def toggle_custom_relevance?
    create?
  end

  def toggle_readable?
    index?
  end

  def vulnerabilities_dashboard?
    index?
  end

  def new_import?
    create?
  end

  def create_import?
    create?
  end

  class Scope < Scope
    def resolve
        scope.all
    end
  end
end
